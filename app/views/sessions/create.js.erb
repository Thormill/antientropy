var regexp_email = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;

<% if logged_in? %>

  sHtml  = '<div class="alert-message success">';
  sHtml += '  <strong><%= I18n.t('user.login.done') %></strong><br/>';
  sHtml += '</div>';

  $('#form-login').html(sHtml);
  $('#modal-login').modal('hide');

  window.location = '/profile/<%= current_user.name %>'
<% else %>
  if ($('#modal-login').css('display') == 'none') { 
    $('#modal-login #form-login  #email').val($('#form-fast-login  #email').val());
    $('#modal-login #form-login  #password').val($('#form-fast-login  #password').val());
  }

  $('#modal-login').modal('show');
  $('#modal-login #form-login #form-error').addClass('alert-message error');
  $('#modal-login #form-login #form-error').html('<strong><%= I18n.t('error') %></strong> <%= I18n.t('user.login.error') %>');

  if ($('#modal-login #form-login  #email').val() == '') {
    $('#modal-login #form-login #input-email').addClass('error')
    $('#modal-login #form-login #input-email .help-inline').html('Введите e-mail');
  } else
    if(regexp_email.test($('#modal-login #form-login  #email').val()) == false) {
      $('#modal-login #form-login #input-email').addClass('error');
      $('#modal-login #form-login #input-email .help-inline').html('Введите корректный e-mail');
    } else {
      $('#modal-login #form-login #input-email').removeClass('error');
      $('#modal-login #form-login #input-email .help-inline').html('');
    }

  if ($('#modal-login #form-login  #password').val() == '') {
    $('#modal-login #form-login #input-password').addClass('error')
    $('#modal-login #form-login #input-password .help-inline').html('Введите пароль');
  } else
    if($('#modal-login #form-login  #password').val().length < 3) {
      $('#modal-login #form-login #input-password').addClass('error');
      $('#modal-login #form-login #input-password .help-inline').html('Пароль не может быть короче трех символов');
    } else {
      $('#modal-login #form-login #input-password').removeClass('error');
      $('#modal-login #form-login #input-password .help-inline').html('');
    }
<% end %>
